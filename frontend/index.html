<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SweetTakr - Chat App</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="src/css/main.css">
    <link rel="stylesheet" href="src/css/components.css">
    <link rel="stylesheet" href="src/css/pages.css">
    <link rel="stylesheet" href="src/css/toast.css">
</head>
<body>
    <div id="app">
        <!-- Auth Pages -->
        <div id="auth-container" class="auth-container">
            <!-- Login Page -->
            <div id="login-page" class="auth-page active">
                <div class="auth-card">
                    <div class="auth-header">
                        <h1 class="app-logo">SweetTakr</h1>
                        <p class="auth-subtitle">Connect with your loved ones</p>
                    </div>
                    <form id="login-form" class="auth-form">
                        <div class="input-group">
                            <input type="text" id="login-email login-phone" name="phone_number" placeholder="Phone Number" required>
                        </div>
                        <div class="input-group">
                            <input type="password" id="login-password" name="password" placeholder="Password" required>
                        </div>
                        <button type="submit" class="btn-primary">Sign In</button>
                    </form>
                    <p class="auth-switch">
                        Don't have an account? 
                        <a href="#" id="show-register">Sign up</a>
                    </p>
                </div>
            </div>

            <!-- Register Page -->
            <div id="register-page" class="auth-page">
                <div class="auth-card">
                    <div class="auth-header">
                        <h1 class="app-logo">SweetTakr</h1>
                        <p class="auth-subtitle">Create your account</p>
                    </div>
                    <form id="register-form" class="auth-form">
                        <div class="input-group">
                            <input type="text" id="register-name" name="name" placeholder="Username" required>
                        </div>
                        <div class="input-group">
                            <input type="tel" id="register-phone" name="phone" placeholder="Phone Number" required>
                        </div>
                        <div class="input-group">
                            <input type="password" id="register-password" name="password" placeholder="Password" required>
                        </div>
                        <div class="input-group">
                            <input type="text" id="register-profile-picture" name="picture" placeholder="Picture URL(optional)">
                        </div>
                        <button type="submit" class="btn-primary">Create Account</button>
                    </form>
                    <p class="auth-switch">
                        Already have an account? 
                        <a href="#" id="show-login">Sign in</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Main Chat Interface -->
        <div id="chat-container" class="chat-container hidden">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="user-profile">
                        <div class="avatar" id="current-user-avatar">
                            <span id="current-user-initials">ST</span>
                        </div>
                        <div class="user-info">
                            <h3 id="current-user-name">User</h3>
                            <span class="user-status online">Online</span>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="icon-btn" id="new-chat-btn" title="New Chat">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                        </button>
                        <!-- temp hide this feature -->
                        <button class="icon-btn hidden" id="settings-btn" title="Settings">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                            </svg>
                        </button>
                        <button class="icon-btn" id="logout-btn" title="Logout">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="search-container">
                    <input type="text" id="search-chats" placeholder="Search conversations" class="search-input">
                </div>

                <div class="chat-list" id="chat-list">
                    <!-- Chat items will be populated here -->
                </div>
            </div>

            <!-- Main Chat Area -->
            <div class="main-chat">
                <!-- Default empty state -->
                <div id="empty-chat" class="empty-chat">
                    <div class="empty-chat-content">
                        <h2>Welcome to SweetTakr</h2>
                        <p>Select a chat to start messaging or create a new conversation</p>
                    </div>
                </div>

                <!-- Active Chat -->
                <div id="active-chat" class="active-chat hidden">
                    <div class="chat-header">
                        <button class="back-btn hidden" id="backBtn" aria-label="Back to chats" title="Back to chats">
                            <!-- left arrow SVG -->
                            <svg viewBox="0 0 24 24" fill="none" stroke="darkgreen" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M19 12H6"></path>
                            <path d="M12 19L5 12 12 5"></path>
                            </svg>
                        </button>
                        <div class="chat-info">
                            <div class="chat-avatar">
                                <span id="chat-contact-initials">AB</span>
                            </div>
                            <div class="chat-details">
                                <h3 id="chat-contact-name">Contact Name</h3>
                                <span id="chat-contact-status" class="contact-status">Online</span>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <!-- temp hide these feature -->
                            <button class="icon-btn hidden" id="voice-call-btn" title="Voice Call">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>
                                </svg>
                            </button>
                            <button class="icon-btn hidden" id="video-call-btn" title="Video Call">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                                </svg>
                            </button>
                            <button class="icon-btn hidden" id="chat-menu-btn" title="Menu">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="messages-container" id="messages-container">
                        <!-- Messages will be populated here -->
                    </div>

                    <div class="message-input-container">
                        <div class="message-input-wrapper">
                            <!-- temp hide this feature -->
                            <button class="icon-btn hidden" id="attachment-btn" title="Attach">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/>
                                </svg>
                            </button>
                            <input type="text" id="message-input" placeholder="Type a message..." class="message-input">
                            <button class="icon-btn" id="voice-record-btn" title="Voice Message">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z M17.3 11c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"/>
                                </svg>
                            </button>
                            <button class="btn-send hidden" id="send-btn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Call Interface -->
        <div id="call-container" class="call-container hidden">
            <div class="call-interface">
                <div class="call-header">
                    <h3 id="call-contact-name">Contact Name</h3>
                    <span id="call-status">Connecting...</span>
                </div>
                
                <div class="call-video-area">
                    <video id="local-video" class="local-video" autoplay muted playsinline></video>
                    <video id="remote-video" class="remote-video" autoplay playsinline></video>
                </div>

                <div class="call-controls">
                    <button class="call-btn mute-btn" id="mute-btn" title="Mute">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z M17.3 11c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"/>
                        </svg>
                    </button>
                    <button class="call-btn video-btn" id="video-btn" title="Toggle Video">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                        </svg>
                    </button>
                    <button class="call-btn end-call-btn" id="end-call-btn" title="End Call">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.7l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.1-.7-.28-.79-.73-1.68-1.36-2.66-1.85-.33-.16-.56-.51-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- New Chat Modal -->
        <div id="new-chat-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>New Chat</h3>
                    <button class="modal-close" id="close-new-chat-modal">×</button>
                </div>
                <div class="modal-body">
                    <div class="search-container">
                        <input type="text" id="search-users" placeholder="Search by name or phone" class="search-input">
                    </div>
                    <div class="user-list" id="user-search-results">
                        <!-- Search results will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
    <script type="module" src="src/js/app.js"></script>
</body>
</html>